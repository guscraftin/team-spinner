/* Thème académique technologique */
:root {
  --black: #000000;
  --white: #ffffff;
  --bg: #05070b;
  --bg-alt: #0b1118;
  --panel: #0f1620;
  --panel-alt: #14202b;
  --blue-1: #0077B6;
  --blue-2: #00B4D8;
  --blue-3: #48CAE4;
  --accent: var(--blue-2);
  --danger: #ff3d5a;
  --success: #48e1a5;
  --radius: 18px;
  --serif: 'Georgia', 'Times New Roman', serif;
  --sans: 'Inter', 'Segoe UI', system-ui, sans-serif;
  --mono: 'JetBrains Mono', 'Source Code Pro', monospace;
  --gradient-blue: linear-gradient(135deg,var(--blue-1),var(--blue-2) 55%,var(--blue-3));
  --focus: 0 0 0 2px var(--black),0 0 0 4px var(--blue-2);
  --shadow-soft: 0 4px 18px -6px rgba(0,0,0,.6), 0 0 0 1px #ffffff10 inset;
  --transition: 180ms cubic-bezier(.4,.2,.2,1);
}

* { box-sizing:border-box; }
html,body { height:100%; }
body.theme-academic {
  margin:0;
  font-family: var(--sans);
  background: radial-gradient(circle at 30% 25%, #0d1722 0%, #05070b 70%);
  color: var(--white);
  overflow-x:hidden;
}

/* Motifs géométriques de fond */
.bg-triangles { position:fixed; inset:0; pointer-events:none; z-index:-1; background:
  repeating-linear-gradient(60deg, #ffffff03 0 12px, transparent 12px 24px),
  radial-gradient(circle at 80% 15%, #00b4d80e, transparent 60%),
  radial-gradient(circle at 15% 75%, #48cae40d, transparent 65%);
  mask: linear-gradient(to bottom, #000 40%, transparent 100%);
}

header { text-align:center; padding: clamp(1.3rem,3vw,3rem) 1rem 1.2rem; position:relative; }
.brand-cluster { display:flex; flex-direction:column; align-items:center; gap: .65rem; }
header h1 { margin:0; font-family: var(--serif); font-weight:600; font-size: clamp(2rem,5vw,3.4rem); letter-spacing:.5px; position:relative; line-height:1.1; }
header h1 .serif { font-style:italic; background:var(--gradient-blue); -webkit-background-clip:text; background-clip:text; color:transparent; text-shadow:0 0 14px #0077b644; }
.subtitle { margin:0; font-size:.9rem; letter-spacing:.8px; opacity:.78; font-family: var(--mono); background:linear-gradient(90deg,#48cae4 0,#0077B6 70%); -webkit-background-clip:text; background-clip:text; color:transparent; }

/* Emblème / lauriers */
.crest { position:relative; width:86px; aspect-ratio:1; background:linear-gradient(140deg,#0d1d29,#081018); border:1px solid #ffffff12; border-radius:18px; display:flex; align-items:center; justify-content:center; box-shadow: var(--shadow-soft); }
.crest:before, .crest:after { content:""; position:absolute; inset:0; border-radius:inherit; background:linear-gradient(190deg,#ffffff12,#ffffff03); mix-blend-mode:overlay; pointer-events:none; }
.crest-inner { position:relative; display:flex; align-items:center; justify-content:center; gap:.4rem; }
.crest-icon { font-size:1.65rem; filter:drop-shadow(0 2px 4px #000); }
.laurel { width:20px; height:44px; background:conic-gradient(from 90deg at 50% 50%, #48cae4 0 25%, #00b4d8 25% 50%, #0077b6 50% 75%, #48cae4 75% 100%); -webkit-mask:radial-gradient(circle at 50% 0, #000 35%, transparent 36%), radial-gradient(circle at 50% 25%, #000 35%, transparent 36%) 0 16px/100% 16px repeat-y; mask:radial-gradient(circle at 50% 0, #000 35%, transparent 36%), radial-gradient(circle at 50% 25%, #000 35%, transparent 36%) 0 16px/100% 16px repeat-y; opacity:.85; }
.laurel.left { transform:scaleX(-1) rotate(-6deg); }
.laurel.right { transform:rotate(6deg); }

main { max-width:1220px; margin:0 auto; padding:0 1.2rem 3.5rem; }

/* Cartes rôles */
.roles-container { display:grid; gap:1.2rem; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); margin-bottom:2.4rem; }
.role-card { position:relative; background:linear-gradient(160deg,#0f1f2a,#0b141c 60%, #091016); border:1px solid #ffffff14; border-radius: var(--radius); padding:1rem 1.1rem 1.3rem; box-shadow: var(--shadow-soft); overflow:hidden; isolation:isolate; }
.role-card:before { content:""; position:absolute; inset:0; background:linear-gradient(120deg,#ffffff0a,#ffffff02); mix-blend-mode:overlay; pointer-events:none; }
.role-card h3 { margin:0; display:flex; align-items:center; gap:.55rem; font: 500 1rem var(--sans); letter-spacing:.6px; text-transform:uppercase; }
.role-pill { font-size:.55rem; letter-spacing:1.2px; font-weight:700; padding:.3rem .55rem; background:#ffffff12; border-radius:999px; color:var(--blue-3); box-shadow:0 0 0 1px #ffffff18 inset; }
.role-name { margin-top:.55rem; font-size:1.45rem; font-family: var(--serif); font-weight:600; text-align:center; background:#121e28; border:1px solid #ffffff12; border-radius:14px; padding:.65rem .8rem; min-height:2.3rem; display:flex; align-items:center; justify-content:center; letter-spacing:.5px; position:relative; }
.role-name.spin { animation: pop .6s ease; }
@keyframes pop { 0% { transform:translateY(6px) scale(.9); opacity:0;} 55% { transform:translateY(-3px) scale(1.04); opacity:1;} 100% { transform:translateY(0) scale(1);} }

/* Roulette tri-slot */
.role-name.rolling { padding:0; background:#101a22; }
.role-roller { position:relative; height:2.8rem; display:flex; flex-direction:column; justify-content:center; overflow:hidden; }
.role-roller-line { position:relative; display:flex; flex-direction:column; }
.role-slot { height:.9rem; display:flex; align-items:center; justify-content:center; font-size:.65rem; opacity:.45; font-family:var(--mono); letter-spacing:.5px; }
.role-slot.current { font-size:1.1rem; height:1.2rem; font-weight:600; opacity:1; font-family:var(--serif); }

/* Exclusions */
.exclusions-panel { background: linear-gradient(160deg,#0f1f2a,#0a1219 70%, #070c11); border:1px solid #ffffff12; border-radius: var(--radius); padding:1.4rem 1.3rem 1.7rem; box-shadow: var(--shadow-soft); }
.section-title { margin:0 0 .7rem; font-size:1.3rem; letter-spacing:.6px; }
.hint { margin:.1rem 0 1.1rem; font-size:.7rem; letter-spacing:.8px; opacity:.65; font-family:var(--mono); }
.exclusions-grid { display:grid; gap:.9rem; grid-template-columns:repeat(auto-fit,minmax(210px,1fr)); }
.ex-block { background:#101c25; border:1px solid #ffffff12; border-radius:15px; padding:.8rem .85rem 1rem; display:flex; flex-direction:column; gap:.55rem; box-shadow:0 3px 10px -4px #000; }
.ex-block h4 { margin:0; font:600 .78rem var(--sans); letter-spacing:1px; text-transform:uppercase; color:var(--blue-3); display:flex; justify-content:space-between; }
.member-list { list-style:none; margin:0; padding:0; display:grid; gap:.4rem; }
.member-list li { position:relative; }
.member-list input { position:absolute; opacity:0; }
.member-list label { display:flex; align-items:center; gap:.55rem; font-size:.7rem; cursor:pointer; background:#ffffff08; padding:.45rem .55rem; border-radius:8px; letter-spacing:.4px; transition:var(--transition); font-family:var(--mono); }
.member-list input:focus-visible + label { outline:var(--focus); }
.member-list input:checked + label { background:var(--blue-2); color:#03161c; font-weight:600; box-shadow:0 0 0 1px #ffffff10 inset; }
.member-list input:not(:checked):hover + label { background:#ffffff14; }

.global-exclusions { display:flex; flex-wrap:wrap; gap:.55rem; margin:0 0 1.1rem; }
.global-exclusions .ge-item { position:relative; }
.global-exclusions input { position:absolute; opacity:0; }
.global-exclusions label { cursor:pointer; background:#ffffff0f; padding:.5rem .85rem; border-radius:40px; font-size:.65rem; letter-spacing:.8px; display:flex; align-items:center; gap:.6ch; font-family:var(--mono); box-shadow:0 0 0 1px #ffffff14 inset; transition:var(--transition); }
.global-exclusions input:checked + label { background:linear-gradient(90deg,var(--blue-1),var(--blue-3)); color:#fff; font-weight:600; box-shadow:0 0 0 1px #ffffff22 inset; }
.global-exclusions input:not(:checked):hover + label { background:#ffffff18; }
.global-exclusions .tag { background:#0009; padding:.2rem .55rem; border-radius:12px; font-size:.55rem; letter-spacing:1px; font-family:var(--sans); }

/* Actions */
.actions { text-align:center; display:flex; flex-direction:column; gap:1rem; margin-top:2.2rem; }
.settings-row { display:flex; flex-direction:column; align-items:center; gap:.5rem; }
.settings-row label { font-size:.75rem; letter-spacing:.9px; font-weight:600; text-transform:uppercase; }
#animDuration { width:min(380px,100%); accent-color: var(--blue-2); }

.draw-btn { --glow: #00b4d8; position:relative; background:var(--gradient-blue); color:#fff; font:600 .95rem var(--sans); letter-spacing:1px; padding:1rem 1.9rem; border:none; border-radius:60px; cursor:pointer; box-shadow:0 10px 28px -10px #0077b6cc, 0 0 0 1px #ffffff30 inset; transition:var(--transition); overflow:hidden; }
.draw-btn:before { content:""; position:absolute; inset:0; background:linear-gradient(120deg,#ffffff24,transparent 60%); mix-blend-mode:overlay; }
.draw-btn:hover { transform:translateY(-3px); box-shadow:0 16px 36px -12px #0077b6, 0 0 0 1px #ffffff30 inset; }
.draw-btn:active { transform:translateY(-1px); }
.draw-btn:disabled { opacity:.45; cursor:not-allowed; filter:grayscale(.3); }

.btn-secondary { background:#ffffff08; border:1px solid #ffffff18; color:var(--white); font:500 .7rem var(--mono); padding:.55rem .95rem; letter-spacing:.8px; border-radius:10px; cursor:pointer; transition:var(--transition); text-transform:uppercase; }
.btn-secondary:hover { background:#ffffff12; }
.btn-secondary:disabled { opacity:.4; cursor:not-allowed; }

.message { min-height:1.2rem; font-size:.8rem; font-family:var(--mono); letter-spacing:.6px; }
.message.success { color:var(--blue-3); }
.message.error { color: var(--danger); }

/* Confetti */
#confettiLayer { position:fixed; inset:0; pointer-events:none; z-index:999; }
.confetti-piece { position:absolute; width:10px; height:14px; top:-20px; opacity:0; animation: fall linear forwards; will-change: transform; }
@keyframes fall { to { transform: translateY(110vh) rotate(var(--rotEnd)); opacity:1; } }

/* Responsive */
@media (max-width:750px){
  .roles-container { grid-template-columns:repeat(auto-fit,minmax(170px,1fr)); gap:.85rem; }
  .role-card { padding:.85rem .75rem 1.05rem; }
  .role-name { font-size:1.25rem; }
  .exclusions-grid { grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); }
  header h1 { font-size: clamp(1.9rem,7vw,2.6rem); }
  .crest { width:70px; }
  .global-exclusions label { font-size:.6rem; padding:.45rem .7rem; }
}
@media (min-width:1400px){
  main { max-width:1340px; }
  .roles-container { grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); }
}

/* Utilitaires */
.serif { font-family: var(--serif); }
.mono { font-family: var(--mono); }

::-webkit-scrollbar { width:10px; }
::-webkit-scrollbar-track { background:#06090d; }
::-webkit-scrollbar-thumb { background:#16222b; border-radius:50px; }
::-webkit-scrollbar-thumb:hover { background:#1e2d38; }

.ex-actions { margin-top:1.2rem; padding-top:1rem; border-top:1px solid #ffffff14; display:flex; justify-content:flex-end; }
